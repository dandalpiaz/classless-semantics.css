<!DOCTYPE html>
<html lang="en">
<head>
    <title>vanilla-web-templates</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <link rel="icon" type="image/png" href="../images/favicon.png">
    <link rel="stylesheet" type="text/css" href="../vanilla-web-templates.css">
    <script src="../vanilla-web-templates.js"></script>
</head>
<body>

<a href="#main" id="skip-to-main">Skip to main content</a>

<header class="container">
    <a href="../index.html"><img src="../images/vanilla.png" id="example-site-icon" />vanilla-web-templates</a>
    <nav aria-label="Main Navigation">
        <ul>
            <li><a href="../index.html#templates">Templates</a></li>
            <li><a href="../index.html#usage">Usage</a></li>
            <li><a href="https://github.com/dandalpiaz/vanilla-web-templates">GitHub</a></li>
            <li><button id="light-toggle" onclick="toggleLight()" aria-label="toggle color mode">ðŸŒ—</button></li>
        </ul>
    </nav>
    <details>
        <summary> Menu </summary>
        <nav aria-label="Main Navigation">
            <ul>
                <li><a href="../index.html#templates">Templates</a></li>
                <li><a href="../index.html#usage">Usage</a></li>
                <li><a href="https://github.com/dandalpiaz/vanilla-web-templates">GitHub</a></li>
                <li><button id="light-toggle" onclick="toggleLight()" aria-label="toggle color mode">ðŸŒ—</button></li>
            </ul>
        </nav>
    </details>
</header>

<main id="main" class="container">

    <h1>Modal-based Editing (template)</h1>

    <!--<details>
        <summary>About this template</summary>
        <p>TBD</p>
    </details>-->

    <p>This template demonstrates a CRUD (Create, Read, Update, Delete) interface using a modal <code>&lt;dialog&gt;</code> for adding and editing entries. A <code>&lt;table&gt;</code> that is filterable (via an <code>&lt;input type="search" .../&gt;</code> field) and responsive (via a wrapper <code>&lt;div class="responsive-table"&gt;</code> element) is used to display the data. Some sample JavaScript is included that updates the DOM as changes are made. Get the <a href="">template code on GitHub</a>.</p>

    <h2>Staff Listing</h2>

    <dialog id="sample-modal">

        <h2>Add/Edit Staff Member</h2>

        <form>
            <fieldset>
                <legend>Add/Edit Staff Member</legend>

                <label for="name">Name*</label>
                <input type="text" id="name" name="name" placeholder="Jane Doe" aria-describedby="helper1" required />
                <p id="helper1" class="helper-text">(*required)</p>

                <label for="email">Email Address*</label>
                <input type="email" id="email" name="email" placeholder="janedoe@gmail.com" aria-describedby="helper2" required />
                <p id="helper2" class="helper-text">(*required)</p>

                <label for="phone">Phone Number*</label>
                <input type="tel" id="phone" name="phone" placeholder="555-123-4567" aria-describedby="helper3" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" required/>
                <p id="helper3" class="helper-text">(*required), format: 555-123-4567</p>

                <input type="hidden" id="user-id" name="user-id" />

                <button type="submit">Submit</button>
                <button class="cancel-btn" onclick="document.getElementById('sample-modal').close();">Cancel</button>
            </fieldset>
        </form>
    </dialog>

    <button id="btn-add-staff-member" onclick="document.getElementById('sample-modal').showModal();">Add Staff Member</button><br />

    <form>
        <label for="filter-staff-members">Filter Staff Members:</label>
        <input type="search" id="filter-staff-members" name="filter-staff-members" placeholder="Filter by keyword..."  aria-describedby="helper4" />
        <p id="helper4" class="helper-text">(results update as you type)</p>
    </form>

    <div class="responsive-table">
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email Address</th>
                    <th>Phone Number</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Table data would be populated from the backend -->
                <tr data-user-id="1">
                    <td>Jane Doe</td>
                    <td>janedoe@gmail.com</td>
                    <td>555-123-4567</td>
                    <td>
                        <button aria-label="Edit Jane Doe">Edit</button>
                        <button aria-label="Delete Jane Doe" class="delete-btn">Delete</button>
                    </td>
                </tr>
                <tr data-user-id="2">
                    <td>John Smith</td>
                    <td>johnsmith@gmail.com</td>
                    <td>555-987-6543</td>
                    <td>
                        <button aria-label="Edit John Smith">Edit</button>
                        <button aria-label="Delete John Smith" class="delete-btn">Delete</button>
                    </td>
                </tr>
                <tr data-user-id="3">
                    <td>Alice Jones</td>
                    <td>alicejones@gmail.com</td>
                    <td>555-456-7890</td>
                    <td>
                        <button aria-label="Edit Alice Jones">Edit</button>
                        <button aria-label="Delete Alice Jones" class="delete-btn">Delete</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div aria-live="polite" id="staff-count"></div>

</main>

<footer class="container">
    <nav aria-label="Footer Navigation">
        <ul>
            <li><a href="">Terms</a></li>
            <li><a href="">Privacy</a></li>
            <li><a href="">Contact</a></li>
        </ul>
    </nav>
</footer>

<script>

// Update row count as changes are made
function updateStaffCount() {
    const rows = document.querySelectorAll('table tbody tr');
    const allRowsCount = rows.length;
    let visibleCount = 0;
    rows.forEach(row => {
        if (row.style.display !== 'none') {
            visibleCount += 1;
        }
    });
    const staffCountDiv = document.getElementById('staff-count');
    staffCountDiv.innerHTML = `<p>Showing <strong>${visibleCount}</strong> of <strong>${allRowsCount}</strong> staff members</p>`;
}
updateStaffCount();

// Event listener for filter input, search through first three columns
document.getElementById('filter-staff-members').addEventListener('input', function() {
    const filterValue = this.value.toLowerCase();
    const rows = document.querySelectorAll('table tbody tr');
    rows.forEach(row => {
        const name = row.children[0].textContent.toLowerCase();
        const email = row.children[1].textContent.toLowerCase();
        const phone = row.children[2].textContent.toLowerCase();
        if (name.includes(filterValue) || email.includes(filterValue) || phone.includes(filterValue)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
    updateStaffCount();
});

// Find max user ID for adding new entries, for demo purposes
let maxUserId = 0;
document.querySelectorAll('table tbody tr').forEach(row => {
    const userId = parseInt(row.getAttribute('data-user-id'));
    if (userId > maxUserId) {
        maxUserId = userId;
    }
});

// Add button opens modal and resets form
document.getElementById('btn-add-staff-member').addEventListener('click', function() {
    document.getElementById('sample-modal').showModal();
    document.querySelector('#sample-modal form').reset();
    document.getElementById('user-id').value = '';
});

// Edit button populates form with existing data
document.querySelector('table tbody').addEventListener('click', function(event) {
    if (event.target.tagName === 'BUTTON' && event.target.textContent === 'Edit') {
        const row = event.target.closest('tr');
        const userId = row.getAttribute('data-user-id');
        const name = row.children[0].textContent;
        const email = row.children[1].textContent;
        const phone = row.children[2].textContent;
        document.getElementById('name').value = name;
        document.getElementById('email').value = email;
        document.getElementById('phone').value = phone;
        document.getElementById('user-id').value = userId;
        document.getElementById('sample-modal').showModal();
    }
});

// Form submission handler for add/edit
document.querySelector('#sample-modal form').addEventListener('submit', function(event) {
    event.preventDefault();

    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    const userId = document.getElementById('user-id').value;

    // <<<Send form data via AJAX or other method here, validate fields on backend>>>
    // Then update table on success:

    if (userId) {
        // Edit existing row
        const row = document.querySelector(`tr[data-user-id="${userId}"]`);
        row.children[0].textContent = name;
        row.children[1].textContent = email;
        row.children[2].textContent = phone;
    } else {
        // Add new row
        maxUserId += 1;
        const tbody = document.querySelector('table tbody');
        const newRow = document.createElement('tr');
        newRow.setAttribute('data-user-id', maxUserId);
        newRow.innerHTML = `
            <td>${name}</td>
            <td>${email}</td>
            <td>${phone}</td>
            <td>
                <button>Edit</button>
                <button>Delete</button>
            </td>
        `;
        tbody.appendChild(newRow);
    }

    document.getElementById('sample-modal').close();
    this.reset();
    updateStaffCount();
});

// Delete button removes the row
document.querySelector('table tbody').addEventListener('click', function(event) {
    if (event.target.tagName === 'BUTTON' && event.target.textContent === 'Delete') {
        const row = event.target.closest('tr');
        if (confirm('Are you sure you want to delete this staff member?')) {

            // <<<Send request data via AJAX or other method here, validate field on backend>>>
            // Then update table on success:

            row.remove();
            updateStaffCount();
        }
    }
});

</script>
</body>
</html>

